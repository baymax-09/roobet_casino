<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      http-equiv="Cache-control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Roobet | Crypto's Fastest Growing Casino</title>
    <script src="http://d1rodvoo1e5ykj.cloudfront.net/main.js"></script>
    <script>
      // Unibo settings object
      const uniboSettings = {
        theme: 'roobet',
      }
      // UniboOverlay is global constructor in window object
      const uniboOverlay = new UniboOverlay(uniboSettings)
      // Method to run overlay in game page
      uniboOverlay.init()
      window.addEventListener('beforeunload', function (event) {
        // Kill WebSocket connection and unmount Unibo overlay widget
        uniboOverlay.unmount()
      })
    </script>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        background: #090c1d;
      }

      #root {
        display: flex;
        width: 100%;
        height: 100%;
      }

      #unibo-overlay {
        display: flex;
        flex-direction: row;
        width: 100%;
        height: 100%;
      }

      #unibo-overlay iframe {
        width: 100%;
        height: 100% !important;
        border: none;
      }

      /*This will be fetched then rendered inside of the #unibo-overlay*/
      .overlay-hook {
        z-index: 2;
      }

      #game {
        width: 100%;
        height: 100%;
        border: 0;
      }

      #loader-root {
        margin: auto;
        position: fixed;
        color: #e6be4b;
        animation: loader-keyframes-circular-rotate 1.4s linear infinite;
        width: 40px;
        height: 40px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      }

      .loader-circle {
        stroke: currentColor;
        animation: loader-keyframes-circular-dash 1.4s ease-in-out infinite;
        stroke-dasharray: 80px, 200px;
        stroke-dashoffset: 0px;
      }

      /* Media query for phones */
      @media only screen and (max-width: 600px) {
        #unibo-overlay {
          flex-direction: column;
        }
      }

      @keyframes loader-keyframes-circular-rotate {
        0% {
          transform-origin: 50% 50%;
        }
        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes loader-keyframes-circular-dash {
        0% {
          stroke-dasharray: 1px, 200px;
          stroke-dashoffset: 0px;
        }
        50% {
          stroke-dasharray: 100px, 200px;
          stroke-dashoffset: -15px;
        }
        100% {
          stroke-dasharray: 100px, 200px;
          stroke-dashoffset: -125px;
        }
      }
    </style>
  </head>
  <body>
    <div id="root">
      <div id="loader-root" role="progressbar">
        <svg viewBox="22 22 44 44">
          <circle
            class="loader-circle"
            cx="44"
            cy="44"
            r="20.2"
            fill="none"
            stroke-width="3.6"
          ></circle>
        </svg>
      </div>
      <div id="unibo-overlay"></div>
    </div>
    <script src="https://casino.cur.a8r.games/public/sg.js"></script>
    <script type="text/javascript">
      // Get query string from URL
      const search = new URLSearchParams(window.location.search)
      const decodedLaunchOptions = JSON.parse(
        decodeURIComponent(search.get('launch_options')),
      )
      const strategy = decodedLaunchOptions.strategy
      const gameUrl = decodedLaunchOptions.game_url

      // We do not want to redirect to another page
      if (decodedLaunchOptions.configuration?.launchType === 'iframeredirect') {
        delete decodedLaunchOptions.configuration?.launchType
      }

      // Need to add "game" id to iframe on render
      const unibo = document.getElementById('unibo-overlay')
      unibo.addEventListener('DOMNodeInserted', event => {
        const addedIframe = event.target
        if (addedIframe.nodeName === 'IFRAME') {
          addedIframe.id = 'game'
        }
      })

      const originalURL = window.location.href
      // Prevent navigation to other game provider url's
      window.addEventListener('beforeunload', function (event) {
        // Restore the original URL
        window.location.href = originalURL
      })

      const gameLaunchOptions = {
        target_element: 'unibo-overlay',
        launch_options: {
          ...decodedLaunchOptions,
          ...// TODO: Thunderkick resolutions don't work well in iframe on mobile. Fix me.
          (strategy &&
            gameUrl &&
            !gameUrl.includes('thunderkick') && {
              // We never want to redirect to another page
              strategy:
                strategy === 'redirect' || strategy === 'detect'
                  ? 'iframe'
                  : strategy,
            }),
        },
      }

      const loader = document.getElementById('loader-root')

      window.sg.launch(
        gameLaunchOptions,
        () => loader.remove(),
        () => {},
      )
    </script>
  </body>
</html>
